{"version":3,"sources":["common/utils.ts"],"names":[],"mappings":"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","file":"common/utils.js","sourcesContent":["export function escapeRegExp(str) {\n    return str.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\");\n}\n\ndeclare global {\n    interface String {\n        trimSlash(leftTrim?: string | boolean, rightTrim?: string | boolean): string\n\n        trim(): string\n\n        getUrlPath(url?: string | boolean, keepQuery?: boolean): string\n\n        createUrl(uri?: string | Array<string>): string\n    }\n}\n\nif (!String.prototype.trim) {\n    String.prototype.trim = function trim() {\n        return this.replace(/^\\s+|\\s+$/g, '')\n    }\n}\n\n/**\n * @param {boolean} [leftTrim]\n * @param {boolean} [rightTrim]\n * @returns {string}\n */\nString.prototype.trimSlash = function trimSlash(leftTrim, rightTrim) {\n    const trimmerPatterns = [];\n\n    if (leftTrim === undefined || leftTrim) {\n        trimmerPatterns.push('^\\/+')\n    }\n    if (rightTrim === undefined || rightTrim) {\n        trimmerPatterns.push('\\/+$')\n    }\n\n    const trimmer = new RegExp(trimmerPatterns.join('|'), 'g');\n\n    return this.replace(trimmer, '')\n}\n\nString.prototype.getUrlPath = function getUrlPath(url, keepQuery) {\n    keepQuery = (keepQuery === undefined && !!url) || keepQuery\n\n    url = (typeof url !== 'boolean' && url !== undefined && String(url)) as string || this as string\n\n    const filters = [];\n    filters.push(escapeRegExp(window.appURLs.homeUrl))\n\n    if (typeof keepQuery === 'boolean' && !keepQuery) {\n        filters.push('\\\\?.+')\n    }\n\n    return url.replace(new RegExp(filters.join('|'), 'ig'), '').replace(/#.*/g, '').trimSlash(false, true)\n}\n\n/**\n * @param {string|string[]}[uri]\n * @returns {string}\n */\nString.prototype.createUrl = function createUrl(uri) {\n    if (uri instanceof Array) {\n        /** @var {Array} uri */\n        uri = uri.join('/')\n    }\n\n    uri = uri ? String(uri) : ''\n\n    const site_url_base = window.appURLs.homeUrl.trimSlash(false, true);\n    const url_path = this.trimSlash() + (uri ? '/' + uri.trimSlash() : '');\n\n    return site_url_base + '/' + url_path.trimSlash()\n}\n\nexport function userTrailingslashit(path) {\n    return path.trimSlash(false, true) + window.appURLs.userTrailingslashit\n}\n\n/**\n * @param {Function} callback Callback function of jQuery Deferred\n * @param [args]\n */\nexport function runCallback(callback: Function, ...args: any[]) {\n    if (!callback) {\n        return;\n    }\n    \n    if (callback instanceof Function) {\n        return callback.apply(this, args)\n    }\n}\n\nexport function capitalize(string) {\n    return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\nexport function onDomReady(documentReadyCallback: Function) {\n    const readyReg = /complete|loaded|interactive/;\n\n    function domLoaded() {\n        document.removeEventListener('DOMContentLoaded', domLoaded, false)\n        documentReadyCallback()\n    }\n\n    if (readyReg.test(document.readyState) && document.body) {\n        domLoaded()\n    }\n    else {\n        document.addEventListener('DOMContentLoaded', domLoaded, false)\n    }\n}\n\nonDomReady(function () {\n    function onGaLinkClick(e: MouseEvent) {\n        if (e.type === 'mouseup' && e.which !== 2) {\n            return\n        }\n\n        let node = <HTMLElement> e.target\n        let deep = 3\n\n        while (deep-- && node && !node.hasAttribute('data-ga')) {\n            node = node.parentElement\n        }\n\n        const gaCategory = node && node.getAttribute('data-ga')\n\n        if (!gaCategory) {\n            return\n        }\n\n        const gaAction = node.getAttribute('data-ga-action')\n\n        if (!gaAction) {\n            return\n        }\n\n        const\n            gaCategories = gaCategory.split('|'),\n            gaActions = gaAction.split('|'),\n            gaDescription = node.getAttribute('data-ga-desc') || node.getAttribute('data-ga-description') || '';\n\n        gaCategories.forEach(function (cat) {\n            gaActions.forEach(function (act) {\n                //_gaq.push(['_trackEvent', cat, act, description])\n                // window.ga && ga('send', 'event', cat, act, gaDescription)\n                gaTrackEvent(cat, act, gaDescription)\n            })\n        })\n    }\n\n    document.addEventListener('click', onGaLinkClick)\n    document.addEventListener('mouseup', onGaLinkClick)\n})\n\ntype GTagAction = {\n    event_category: string\n    event_action: string | number\n    event_label?: string | number\n}\n\nexport function gaTrackEvent(cat: string, act?: string | number | GTagAction, desc?: string | number, yaVisitParams?: object) {\n    window._gaq && _gaq.push(['_trackEvent', cat, act, desc])\n\n    window.ga && ga('send', 'event', cat, String(act), desc)\n\n    if (!yaVisitParams) {\n        if (desc) {\n            yaVisitParams = {\n                [cat]: {[<any>act]: desc}\n            }\n        }\n        else {\n            yaVisitParams = {\n                [cat]: act\n            }\n        }\n    }\n\n    window.yaCounterInstance && yaCounterInstance.params(yaVisitParams)\n\n    window.top100Counter && top100Counter.sendCustomVars(yaVisitParams)\n\n    if (window.gtag) {\n        let actionParams: GTagAction\n\n        if (typeof act === 'number' || typeof act === 'string' || act instanceof String) {\n            actionParams = {\n                event_category: String(cat),\n                event_action: String(act)\n            }\n\n            if (desc) {\n                actionParams.event_label = String(desc)\n            }\n        }\n        else {\n            actionParams = act\n\n            cat = cat || actionParams.event_category\n        }\n\n        gtag('event', cat, actionParams)\n    }\n}\n\nexport function gaTrackPageView(path = location.pathname) {\n    window.ga && ga('send', 'pageview', path)\n\n    window.gtag && gtag('event', 'page_view', path)\n\n    window.gtag && gtag('config', GA_TRACKING_ID, {\n        page_path: path\n    })\n\n    if (window.gtag && !window.GA_TRACKING_ID) {\n        console.error('global var `GA_TRACKING_ID` is not defined')\n    }\n\n    window.yaCounterInstance && yaCounterInstance.hit(path)\n\n    window.top100Counter && top100Counter.trackPageview(path)\n}\n\nexport function templateTrim(templateHtml: string) {\n    return templateHtml.replace(/\\/{2,}<!\\[CDATA\\[([\\s\\S]*)\\/{2,}]]>/i, '$1').trim()\n}\n\nexport function nodeOffset(node: HTMLElement): {top: number, left: number} {\n    let offsetTop = 0,\n        offsetLeft = 0,\n        offsetParent = node;\n\n    while (offsetParent) {\n        offsetTop += offsetParent.offsetTop\n        offsetLeft += offsetParent.offsetLeft\n\n        offsetParent = <HTMLElement> offsetParent.offsetParent\n    }\n\n    return {top: offsetTop, left: offsetLeft}\n}\n\nexport function nodeOffsetTop(node: HTMLElement) {\n    return nodeOffset(node).top\n}\n\nexport function closestNode(node: HTMLElement, classNameOrNode) {\n    let classNameRegexp,\n        targetNode\n    \n    if (classNameOrNode instanceof HTMLElement) {\n        targetNode = classNameOrNode\n    }\n    else {\n        classNameOrNode = classNameOrNode.replace(/^\\.+/, '')\n    }\n\n    while (node) {\n        if (targetNode) {\n            if (targetNode === node) {\n                return node\n            }\n        }\n        else if (node.classList.contains(classNameOrNode)) {\n            return node\n        }\n\n        node = <HTMLElement> node.parentNode\n    }\n}\n\n/**\n * Converts HTML Attr to boolean\n */\nexport function toBoolean(string: string | boolean | null | undefined) : boolean {\n    if (typeof string === 'boolean') {\n        return string\n    }\n    else if (string === null || string === undefined) {\n        return false\n    }\n\n    string = String(string).toLowerCase()\n\n    switch (string) {\n        case '0':\n        case false.toString():\n            return false\n\n        case true.toString():\n            return true\n\n        default:\n            return true\n    }\n}\n\nexport function getBgImageUrl($el) {\n    const el = $el instanceof HTMLElement ? $el : (window['jQuery'] && $el instanceof window['jQuery'] && $el.get(0))\n\n    if (!el) {\n        return ''\n    }\n\n    const backgroundImage = getComputedStyle(el).backgroundImage\n\n    if (!backgroundImage || backgroundImage === 'none') {\n        return ''\n    }\n\n    return backgroundImage.replace(/url\\(['\"]?/,'').replace(/['\"]?\\)/, '')\n}\n\ninterface LoadSvgIconsInterface {\n    (el: HTMLElement): void\n    shouldUseFallback?: () => boolean\n}\n\nconst loadSvgIcons: LoadSvgIconsInterface = function loadSvgIcons(el: HTMLElement): void {\n    Array.prototype.forEach.call(el.querySelectorAll('svg use'), function (svgUseNode) {\n        const context = this || window\n\n        const hrefAttributes = ['xlink:href', 'href']\n\n        let hrefAttribute, href\n\n        hrefAttributes.some(function (attribute) {\n            href = svgUseNode.getAttribute(attribute)\n\n            hrefAttribute = attribute\n\n            return href\n        })\n\n        if (!href) {\n            return\n        }\n\n        let hrefParams = href.match(/^([\\s\\S]+)(#[\\s\\S]*)$/)\n\n        if (!hrefParams) {\n            return\n        }\n\n        let [, hrefUrl, hrefId] = hrefParams\n\n        svgUseNode.setAttribute(hrefAttribute, hrefId)\n\n        context._loadedSvgUrls = context._loadedSvgUrls || []\n\n        if (context._loadedSvgUrls.indexOf(hrefUrl) !== -1) {\n            return\n        }\n\n        context._loadedSvgUrls.push(hrefUrl)\n\n        const request = new XMLHttpRequest()\n\n        request.onload = function (xhr) {\n            if (/xml/.test(request.getResponseHeader('Content-Type'))) {\n                document.body.insertAdjacentHTML('beforeend', request.response)\n            }\n        }\n\n        request.open('get', hrefUrl, true)\n        request.send()\n    }, this)\n}\n\nloadSvgIcons.shouldUseFallback = function () {\n    return /MSIE|Trident/.test(navigator.userAgent)\n}\n\nexport {loadSvgIcons}\n\nexport function getAppOption(property: keyof AppConfig): any {\n    return (window.appConfig && appConfig.hasOwnProperty(property)) ? appConfig[property] : undefined\n}"],"sourceRoot":"../../../../src/ts"}